<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PERÚ FUERTE: Escudo de Hierro - Panel Interactivo del Proyecto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Estilos personalizados para la tipografía, el fondo y la interactividad -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8; /* Fondo suave */
            color: #403A3A; /* Texto principal */
        }
        /* Contenedor de gráficos flexible y responsivo */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        /* Estilo para las tarjetas de estadísticas */
        .stat-card {
            background-color: #FFFFFF;
            border: 1px solid #EAEAEA;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* Estilos de navegación y enlaces activos */
        .nav-link {
            transition: color 0.2s ease;
        }
        .nav-link:hover, .nav-link.active {
            color: #C73E1D; /* Rojo Principal */
            border-bottom: 2px solid #C73E1D;
        }
        /* Estilos para el selector de Ejes Estratégicos (Acordeón lateral) */
        .axis-item {
            cursor: pointer;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        .axis-item.active, .axis-item:hover {
            border-left-color: #C73E1D;
            background-color: #FFF9F7;
        }
        /* Estilos de la Línea de Tiempo */
        .timeline-item {
            position: relative;
            padding-bottom: 2rem;
            padding-left: 2.5rem;
            border-left: 2px solid #EAEAEA;
        }
        .timeline-dot {
            position: absolute;
            left: -0.5rem;
            top: 0;
            height: 1rem;
            width: 1rem;
            border-radius: 9999px;
            background-color: #EAEAEA;
            border: 2px solid #FFFFFF;
        }
        .timeline-item.active .timeline-dot {
            background-color: #C73E1D;
        }
        .timeline-item.active {
            border-left-color: #C73E1D;
        }
    </style>
</head>
<body class="antialiased">
    <!-- Barra de Navegación Fija -->
    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-gray-200">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-4">
                    <!-- Logo y Título -->
                    <img src="logo.jpeg" onerror="this.onerror=null;this.src='https://placehold.co/100x40/c73e1d/ffffff?text=LOGO';" alt="Logo Renovador Impulso" class="h-10 w-auto rounded-md">
                    <div> <!-- Contenedor para el nombre del proyecto y la ONG -->
                        <h1 class="text-xl font-bold text-gray-800 leading-none">PERÚ FUERTE: Escudo de Hierro</h1>
                        <!-- Nombre de la ONG con énfasis visual -->
                        <p class="text-lg font-bold text-[#1D9A95] mt-0.5">ONG RENOVADOR IMPULSO</p>
                    </div>
                </div>
                <!-- Menú de Navegación Desktop -->
                <nav class="hidden md:flex space-x-8">
                    <a href="#panorama" class="nav-link font-medium text-gray-600 pb-1">Panorama</a>
                    <a href="#estrategia" class="nav-link font-medium text-gray-600 pb-1">Estrategia</a>
                    <a href="#inversion" class="nav-link font-medium text-gray-600 pb-1">Inversión</a>
                    <a href="#metas" class="nav-link font-medium text-gray-600 pb-1">Metas</a>
                </nav>
                <!-- Nota: En un entorno real, aquí iría un botón de menú para móvil -->
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <!-- Sección Principal (HERO) -->
        <section id="hero" class="text-center mb-16">
            <p class="text-xl md:text-3xl font-semibold text-[#C73E1D] max-w-4xl mx-auto">Proyecto social de alto impacto para la reducción acelerada de la anemia y la desnutrición crónica infantil en el Perú</p>
            
            <p class="text-lg md:text-2xl font-bold text-blue-600 mt-2 max-w-4xl mx-auto">Noviembre - 2025 a Diciembre - 2027</p>

            <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                <div class="stat-card p-6 rounded-xl text-center shadow-lg">
                    <!-- Modificado: S/ 130 M a S/ 130 Millones -->
                    <p class="text-3xl font-bold text-[#C73E1D]">S/ 130 Millones</p>
                    <p class="text-gray-500 mt-1">Presupuesto Total</p>
                </div>
                <div class="stat-card p-6 rounded-xl text-center shadow-lg">
                    <p class="text-3xl font-bold text-[#C73E1D]">26 Meses</p>
                    <p class="text-gray-500 mt-1">Periodo de Ejecución</p>
                </div>
                <div class="stat-card p-6 rounded-xl text-center shadow-lg">
                    <p class="text-3xl font-bold text-[#C73E1D]">10 Regiones</p>
                    <p class="text-gray-500 mt-1">Foco Prioritario</p>
                </div>
            </div>
        </section>

        <!-- Sección 1: Panorama de la Anemia -->
        <section id="panorama" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-4">Panorama de la Anemia en Perú</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-10">La anemia y la Desnutrición Crónica Infantil (DCI) persisten como un desafío nacional, con marcadas diferencias entre regiones. Esta sección visualiza el diagnóstico actual y la meta de reducción del proyecto, permitiendo explorar los datos de las zonas más críticas.</p>
            
            <div class="grid md:grid-cols-2 gap-8 items-start">
                <!-- Gráfico de Comparación Regional -->
                <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-md">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4">
                        <h3 class="text-xl font-semibold mb-2 sm:mb-0">Índices Regionales (2024 Est.)</h3>
                        <select id="regionSelector" class="border border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-[#C73E1D]">
                        </select>
                    </div>
                    <p class="text-sm text-gray-500 mb-4">Seleccione una región para comparar sus índices con el promedio nacional.</p>
                    <div class="chart-container h-[350px] md:h-[400px]">
                        <canvas id="regionalAnemiaChart"></canvas>
                    </div>
                </div>

                <!-- Gráfico de Proyección Nacional -->
                <div class="space-y-6">
                   <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-md">
                        <h3 class="text-xl font-semibold mb-4">Proyección de Reducción de Anemia</h3>
                        <p class="text-sm text-gray-500 mb-4">Meta: Reducir la prevalencia de anemia (41.8% a 25.0%) para fines de 2027.</p>
                        <div class="chart-container h-[250px] md:h-[300px]">
                            <canvas id="anemiaReductionChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sección 2: Estrategia de 5 Ejes -->
        <section id="estrategia" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-4">Nuestra Estrategia: 5 Ejes Integrales</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-10">El proyecto se articula en cinco ejes de intervención que actúan de forma coordinada. Haga clic en cada eje para conocer los detalles.</p>
            
            <div class="md:grid md:grid-cols-3 md:gap-8">
                <!-- Selector de Ejes (Barra lateral) -->
                <div id="axis-selector" class="md:col-span-1 mb-8 md:mb-0 bg-white rounded-xl border border-gray-200 shadow-md p-2">
                    <!-- Contenido generado por JS -->
                </div>

                <!-- Detalles del Eje Seleccionado -->
                <div id="axis-details" class="md:col-span-2 bg-white p-8 rounded-xl border border-gray-200 shadow-md min-h-[300px] flex flex-col justify-center">
                    <!-- Contenido del Eje 1 por defecto (generado por JS) -->
                </div>
            </div>
        </section>

        <!-- Sección 3: Inversión y Cronograma -->
        <section id="inversion" class="mb-16 scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-4">Plan de Inversión y Cronograma</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-10">La inversión de S/ 130 millones se distribuye estratégicamente entre los cinco ejes y se ejecuta en tres fases clave.</p>
            <div class="grid md:grid-cols-5 gap-8 items-start">
                <!-- Gráfico de Distribución Presupuestal -->
                <div class="md:col-span-2 bg-white p-6 rounded-xl border border-gray-200 shadow-md">
                    <h3 class="text-xl font-semibold mb-4 text-center">Distribución Presupuestal por Eje</h3>
                     <div class="chart-container h-[300px] md:h-[350px]">
                        <canvas id="budgetDonutChart"></canvas>
                    </div>
                </div>
                <!-- Línea de Tiempo -->
                <div class="md:col-span-3 bg-white p-6 rounded-xl border border-gray-200 shadow-md">
                    <h3 class="text-xl font-semibold mb-6">Fases del Proyecto (Nov 2025 - Dic 2027)</h3>
                    <div id="timeline-container">
                        <!-- Contenido generado por JS -->
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Sección 4: Indicadores y Metas -->
        <section id="metas" class="scroll-mt-20">
            <h2 class="text-3xl font-bold text-center mb-4">Indicadores de Impacto y Metas al 2027</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-10">El éxito se medirá a través de Indicadores Clave de Desempeño (KPIs) monitoreando el progreso desde la línea base hasta las metas finales.</p>
            <div id="kpi-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Tarjetas de KPI generadas por JS -->
            </div>
        </section>
    </main>

    <!-- Pie de Página -->
    <footer class="bg-gray-800 text-white mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center">
            <!-- Nombre de la ONG con énfasis visual -->
            <p class="font-extrabold text-[#1D9A95] text-lg">ONG RENOVADOR IMPULSO</p>
            <p class="text-sm text-gray-400">Comprometidos con el futuro del Perú.</p>
            <p class="text-xs text-gray-500 mt-2">RUC: 20551632513 | Jr. Las Nepentas Mz. R Lt. 06 Dpto. A, Urb. S, San Juan de Lurigancho, Lima – Perú</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Datos Estáticos del Proyecto
            const projectData = {
                // Datos regionales clave para el gráfico de comparación
                regionalData: [
                    // Información actualizada de las 10 regiones priorizadas según proyecto_anemia_peru.md (2024E)
                    { region: 'Puno', anemia: 69.0, dci: 24.5 },
                    { region: 'Huancavelica', anemia: 59.8, dci: 28.0 },
                    { region: 'Ucayali', anemia: 62.5, dci: 18.9 },
                    { region: 'Loreto', anemia: 54.7, dci: 17.1 },
                    { region: 'Madre de Dios', anemia: 55.1, dci: 15.2 },
                    { region: 'Cajamarca', anemia: 50.3, dci: 20.4 },
                    { region: 'Ayacucho', anemia: 49.5, dci: 19.8 },
                    { region: 'Amazonas', anemia: 48.9, dci: 16.5 },
                    { region: 'Pasco', anemia: 47.0, dci: 14.3 },
                    { region: 'San Martín', anemia: 45.2, dci: 13.5 }
                ],
                nationalAverage: { anemia: 41.8, dci: 11.2 },
                anemiaProjection: { start: 41.8, end: 25.0 }, // Proyección de reducción de anemia
                
                // Datos de los 5 Ejes Estratégicos y su presupuesto
                strategyAxes: [
                    { 
                        title: "Eje 1: Nutrición y Suministro",
                        icon: "💊",
                        description: "Adquisición, producción y distribución de micronutrientes y alimentos fortificados. Se enfoca en garantizar que los insumos de alta calidad lleguen a la población objetivo de manera oportuna y eficiente.",
                        budget: 52000000.00
                    },
                    { 
                        title: "Eje 2: Capacitación Comunitaria",
                        icon: "👩‍🏫",
                        description: "Formación intensiva de madres, cuidadores y docentes en prácticas óptimas de alimentación y salud infantil a través de la metodología 'Madres de Hierro', empoderando a la comunidad.",
                        budget: 19500000.00
                    },
                    { 
                        title: "Eje 3: Articulación Intersectorial",
                        icon: "🤝",
                        description: "Contratación de servicios especializados como logística y formalización de convenios con entidades públicas (DRE, Gobiernos Regionales) y privadas para asegurar una ejecución coordinada y eficaz.",
                        budget: 13000000.00
                    },
                    { 
                        title: "Eje 4: Despliegue en Campo",
                        icon: "🏞️",
                        description: "Movilización de brigadas multidisciplinarias para realizar campañas masivas de tamizaje de hemoglobina, desparasitación y seguimiento domiciliario en las zonas de más difícil acceso.",
                        budget: 32500000.00
                    },
                    { 
                        title: "Eje 5: Innovación y Monitoreo",
                        icon: "📱",
                        description: "Desarrollo y uso de la plataforma digital 'Escudo App' para el seguimiento georreferenciado en tiempo real de los casos, permitiendo una toma de decisiones basada en datos y optimizando recursos.",
                        budget: 13000000.00
                    }
                ],
                // Cronograma del proyecto
                timeline: [
                    { phase: "1. Planificación y Contratación", period: "Nov 2025 – Abr 2026", objective: "Formalizar convenios, licitar proveedores clave, reclutar personal y desarrollar la versión inicial de 'Escudo App'.", active: true },
                    { phase: "2. Despliegue e Implementación", period: "May 2026 – Jun 2027", objective: "Movilizar brigadas, iniciar campañas de tamizaje, lanzar talleres 'Madres de Hierro' y distribuir masivamente los suplementos.", active: false },
                    { phase: "3. Consolidación y Evaluación", period: "Jul 2027 – Dic 2027", objective: "Medir el impacto del proyecto, ajustar estrategias, consolidar la data y transferir capacidades a las autoridades locales para la sostenibilidad.", active: false }
                ],
                // Indicadores Clave de Desempeño (KPIs)
                kpis: [
                    { title: "Reducción de Anemia", baseline: "41.8%", target: "25.0%", value: 41.8, goal: 25.0, unit: "%" },
                    { title: "Reducción de DCI", baseline: "11.2%", target: "8.0%", value: 11.2, goal: 8.0, unit: "%" },
                    { title: "Cobertura de Suplementación", baseline: "65%", target: "90%", value: 65, goal: 90, unit: "%" },
                    { title: "Madres Capacitadas", baseline: "0", target: "50,000", value: 0, goal: 50000, unit: "" },
                    { title: "Uso de 'Escudo App'", baseline: "0%", target: "100%", value: 0, goal: 100, unit: "%" },
                ]
            };
            
            // Configuración Global de Chart.js
            Chart.defaults.font.family = 'Inter';
            Chart.defaults.color = '#6b7280';
            
            // Elementos del DOM
            const regionSelector = document.getElementById('regionSelector');
            const axisSelector = document.getElementById('axis-selector');
            const axisDetailsContainer = document.getElementById('axis-details');
            const timelineContainer = document.getElementById('timeline-container');
            const kpiContainer = document.getElementById('kpi-container');

            let regionalAnemiaChart, anemiaReductionChart, budgetDonutChart;
            
            // --- Funciones de Gráficos ---

            /**
             * Inicializa el gráfico de barras para la comparación regional de Anemia y DCI.
             */
            function setupRegionalAnemiaChart() {
                const ctx = document.getElementById('regionalAnemiaChart').getContext('2d');
                
                // Llenar el selector de regiones
                // Nota: Los datos de Ucayali y Madre de Dios son reordenados ligeramente aquí para seguir el orden exacto del MD, aunque funcionalmente no es estricto.
                projectData.regionalData.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.region;
                    option.textContent = item.region;
                    regionSelector.appendChild(option);
                });

                regionalAnemiaChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Anemia', 'Desnutrición Crónica (DCI)'],
                        datasets: [] // Se llena en updateRegionalAnemiaChart
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100, // Máximo 100%
                                title: { display: true, text: 'Prevalencia (%)' },
                                grid: { color: '#e5e7eb' }
                            },
                            x: {
                                grid: { display: false }
                            }
                        },
                        plugins: {
                            legend: { position: 'top' },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw}%`;
                                    }
                                }
                            }
                        }
                    }
                });
                updateRegionalAnemiaChart(regionSelector.value); // Carga la primera región por defecto
            }

            /**
             * Actualiza el gráfico de barras con los datos de la región seleccionada.
             * @param {string} regionName - Nombre de la región seleccionada.
             */
            function updateRegionalAnemiaChart(regionName) {
                const selectedRegion = projectData.regionalData.find(r => r.region === regionName);
                if (!selectedRegion) return;

                regionalAnemiaChart.data.datasets = [
                    {
                        label: `Promedio Nacional`,
                        data: [projectData.nationalAverage.anemia, projectData.nationalAverage.dci],
                        backgroundColor: '#9CA3AF', // Gris para el promedio nacional
                        borderColor: '#6B7280',
                        borderWidth: 1,
                        barPercentage: 0.6
                    },
                    {
                        label: `${selectedRegion.region}`,
                        data: [selectedRegion.anemia, selectedRegion.dci],
                        backgroundColor: '#C73E1D', // Rojo principal del proyecto
                        borderColor: '#A83219',
                        borderWidth: 1,
                        barPercentage: 0.6
                    }
                ];
                regionalAnemiaChart.update();
            }

            /**
             * Inicializa el gráfico de línea para la proyección de reducción de anemia.
             */
            function setupAnemiaReductionChart() {
                const ctx = document.getElementById('anemiaReductionChart').getContext('2d');
                anemiaReductionChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Línea Base (2024)', 'Meta (2027)'],
                        datasets: [{
                            label: 'Prevalencia de Anemia (%)',
                            data: [projectData.anemiaProjection.start, projectData.anemiaProjection.end],
                            borderColor: '#C73E1D',
                            backgroundColor: 'rgba(199, 62, 29, 0.2)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointBackgroundColor: ['#403A3A', '#C73E1D'] // Punto inicial y final diferenciados
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: false,
                                min: projectData.anemiaProjection.end - 5,
                                max: projectData.anemiaProjection.start + 5,
                                title: { display: true, text: 'Prevalencia (%)' },
                                grid: { color: '#e5e7eb' }
                            },
                            x: {
                                grid: { display: false }
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: (context) => `${context.raw.toFixed(1)}%`
                                }
                            }
                        }
                    }
                });
            }
            
            /**
             * Inicializa el gráfico de dona para la distribución presupuestal.
             */
            function setupBudgetDonutChart() {
                const ctx = document.getElementById('budgetDonutChart').getContext('2d');
                budgetDonutChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: projectData.strategyAxes.map(axis => axis.title.split(':')[0].trim()),
                        datasets: [{
                            data: projectData.strategyAxes.map(axis => axis.budget),
                            // Colores inspirados en el tono principal y complementarios neutros
                            backgroundColor: ['#C73E1D', '#F9C784', '#6699CC', '#403A3A', '#9B59B6'], 
                            borderColor: '#FFFFFF',
                            borderWidth: 2,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    boxWidth: 15,
                                    padding: 15
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        const value = context.raw;
                                        const total = context.chart.getDatasetMeta(0).total;
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        
                                        return `${label}: S/ ${value.toLocaleString('es-PE', {minimumFractionDigits: 2})} (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // --- Funciones de Interfaz (Estrategia, Timeline, KPIs) ---

            /**
             * Renderiza el selector de ejes estratégicos (barra lateral).
             */
            function renderStrategyAxes() {
                projectData.strategyAxes.forEach((axis, index) => {
                    const item = document.createElement('div');
                    // Usamos la clase 'axis-item' para el borde izquierdo dinámico
                    item.className = 'axis-item p-4 mb-2 rounded-r-lg';
                    item.dataset.index = index;
                    item.innerHTML = `<div class="flex items-center"><span class="text-2xl mr-4">${axis.icon}</span><span class="font-semibold">${axis.title}</span></div>`;
                    axisSelector.appendChild(item);
                });
                
                // Manejador de eventos para cambiar el detalle del eje
                axisSelector.addEventListener('click', (e) => {
                    const targetItem = e.target.closest('.axis-item');
                    if(targetItem) {
                        const index = targetItem.dataset.index;
                        updateAxisDetails(index);
                        // Desactivar todos los ítems y activar el seleccionado
                        document.querySelectorAll('.axis-item').forEach(item => item.classList.remove('active'));
                        targetItem.classList.add('active');
                    }
                });
                
                // Mostrar detalles del primer eje por defecto y activarlo
                updateAxisDetails(0);
                if (axisSelector.children.length > 0) {
                    axisSelector.children[0].classList.add('active');
                }
            }

            /**
             * Actualiza el panel de detalles del eje estratégico.
             * @param {number} index - Índice del eje a mostrar.
             */
            function updateAxisDetails(index) {
                const axis = projectData.strategyAxes[index];
                if (!axis) return;
                
                // Formateo del presupuesto
                const budgetFormatted = `S/ ${axis.budget.toLocaleString('es-PE', {minimumFractionDigits: 2})}`;
                
                axisDetailsContainer.innerHTML = `
                    <div class="flex items-start mb-4">
                        <span class="text-3xl mr-4">${axis.icon}</span>
                        <h3 class="text-2xl font-bold">${axis.title}</h3>
                    </div>
                    <p class="text-xl font-semibold text-[#C73E1D] mb-4">${budgetFormatted}</p>
                    <p class="text-gray-600 leading-relaxed">${axis.description}</p>
                `;
            }

            /**
             * Renderiza la línea de tiempo del proyecto.
             */
            function renderTimeline() {
                projectData.timeline.forEach(item => {
                    const div = document.createElement('div');
                    // Clase 'timeline-item' y 'active' si es la fase actual
                    div.className = `timeline-item ${item.active ? 'active' : ''}`;
                    div.innerHTML = `
                        <div class="timeline-dot"></div>
                        <p class="text-xs text-gray-500">${item.period}</p>
                        <h4 class="font-semibold text-lg text-gray-800">${item.phase}</h4>
                        <p class="text-gray-600 mt-1">${item.objective}</p>
                    `;
                    timelineContainer.appendChild(div);
                });
            }

            /**
             * Renderiza las tarjetas de KPIs con barra de progreso.
             */
            function renderKPIs() {
                projectData.kpis.forEach(kpi => {
                    // Dado que el dashboard muestra la propuesta al inicio (baseline), 
                    // la barra de progreso se inicializa en 0% ya que aún no hay avance.
                    const progress = 0; 
                    
                    const card = document.createElement('div');
                    card.className = 'stat-card p-6 rounded-xl shadow-md';
                    card.innerHTML = `
                        <h4 class="font-semibold text-gray-800">${kpi.title}</h4>
                        <div class="flex justify-between items-baseline mt-2">
                            <span class="text-sm text-gray-500">Línea Base: ${kpi.baseline}</span>
                            <span class="text-lg font-bold text-[#C73E1D]">Meta: ${kpi.target}</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-3">
                            <div class="bg-[#C73E1D] h-2.5 rounded-full" style="width: ${progress}%"></div>
                        </div>
                        <p class="text-xs text-right text-gray-500 mt-1">${progress.toFixed(0)}% de avance (Línea Base)</p>
                    `;
                    kpiContainer.appendChild(card);
                });
            }

            /**
             * Configura el desplazamiento suave de la navegación.
             */
            function setupNavScroll() {
                document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault();
                        const targetId = this.getAttribute('href');
                        document.querySelector(targetId).scrollIntoView({
                            behavior: 'smooth'
                        });
                        
                        // Resaltar el enlace activo
                        document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
                        this.classList.add('active');
                    });
                });
            }

            // --- Inicialización General ---
            setupRegionalAnemiaChart();
            regionSelector.addEventListener('change', (e) => updateRegionalAnemiaChart(e.target.value));
            setupAnemiaReductionChart();
            setupBudgetDonutChart();
            renderStrategyAxes();
            renderTimeline();
            renderKPIs();
            setupNavScroll();
        });
    </script>
</body>
</html>
